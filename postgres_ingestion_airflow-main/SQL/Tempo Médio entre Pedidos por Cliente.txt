SELECT 
    ROUND(
        COUNT(*) FILTER (WHERE pedidos > 1)::numeric / COUNT(*) * 100, 
        2
    ) AS taxa_recompra_percentual
FROM (
    SELECT "CustomerID", COUNT(DISTINCT "SalesOrderID") AS pedidos
    FROM fato_vendas
    GROUP BY "CustomerID"
) sub;